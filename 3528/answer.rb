M=100
f = ->q{q=~/\d/ ? q.to_i : q.ord-?A.ord+10}
d,s,g = gets.chars
s = f[s]
map = [[[1,0,1,1,M,?0],[1,1,0,1,M,?1],[0,0,0,1,M,?2],[0,1,0,1,M,?3],[0,0,0,1,M,?4],[0,1,1,1,M,?5]],
       [[1,1,0,0,M,?6],[0,1,0,1,M,?7],[0,1,1,0,M,?8],[1,0,0,1,M,?9],[0,0,1,0,M,?A],[1,0,1,1,M,?B]],
       [[1,1,0,1,M,?C],[0,0,1,1,M,?D],[1,0,1,1,M,?E],[1,1,1,0,M,?F],[1,1,1,0,M,?G],[1,0,1,0,M,?H]],
       [[1,0,0,1,M,?I],[0,0,0,0,M,?J],[0,1,0,0,M,?K],[0,1,1,1,M,?L],[1,0,0,1,M,?M],[0,0,1,0,M,?N]],
       [[1,0,1,0,M,?O],[1,1,1,0,M,?P],[1,0,0,1,M,?Q],[0,1,0,1,M,?R],[0,1,1,0,M,?S],[1,0,1,0,M,?T]],
       [[1,1,0,0,M,?U],[0,1,0,1,M,?V],[0,1,1,0,M,?W],[1,1,0,1,M,?X],[0,1,0,1,M,?Y],[0,1,1,0,M,?Z]]]
map[s/6][s%6][4] = 0

# Open the door.
case d
when ?a
  map[1][1][1] = 0
  map[2][1][3] = 0
when ?b
  map[2][2][2] = 0
  map[2][3][0] = 0
when ?c
  map[2][4][1] = 0
  map[3][4][3] = 0
when ?d
  map[1][4][2] = 0
  map[1][5][0] = 0
end

ls = [[s/6, s%6]]
while l = ls.shift
  m = map[l[0]][l[1]]
  break if m[5] == g
  [[0,-1],[1,0],[0,1],[-1,0]].each_with_index{|(dy, dx), i|
    y, x = l[0]+dy, l[1]+dx
    if m[i] == 0 && map[y][x][4] > m[4]
      ls.push([y, x])
      map[y][x][4] = m[4] + 1
    end
  }
end

g = f[g]
puts map[g/6][g%6][4]
